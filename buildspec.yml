version: 0.2

#env:
  #variables:
     # key: "value"
     # key: "value"
  #parameter-store:
     # key: "value"
     # key: "value"

phases:
  #install:
   # commands:
    #   - 
      # - command
  #pre_build:
    #commands:
      # - command
      # - command
  build:
    commands:
       - touch /tmp/test && touch /tmp/test22
      # - command
  post_build:
    commands:
       - echo 'Warning!!!'
       - echo $CODEBUILD_BUILD_SUCCEEDING
       - PL_NUMBER=`echo $CODEBUILD_SOURCE_VERSION | cut -c 4-`
       - echo $PL_NUMBER
       if [ -z "$CODEBUILD_BUILD_SUCCEEDING" ]; then  echo 'curl -X POST https://api.github.com/repos/felvis/test/pulls/3/reviews -H 'authorization: Bearer $TOKEN' -H 'content-type: application/json' -d '{"body":"Need to be fixed", "event":"REQUEST_CHANGES"}'"
'; else echo 'curl -X PUT https://api.github.com/repos/felvis/test/pulls/$PL_NUMBER/merge -H 'authorization: Bearer $KEY' -H 'content-type: application/json' -d '{"commit_message":"s3link"}''; fi
       - echo $CODEBUILD_RESOLVED_SOURCE_VERSION
artifacts:
  files:
     - /tmp/*
    # - location
  #discard-paths: yes
  #base-directory: location
#cache:
  #paths:
    # - paths
